"use strict";
(function($window) {
  "use strict";
  var collections = [];
  var Catwalk = function Catwalk() {
    this.typecast = new $window.Catwalk.Typecast();
  };
  ($traceurRuntime.createClass)(Catwalk, {
    createCollection: function(name, properties) {
      var collection = new $window.Catwalk.Collection(name, properties);
      collections[name] = collection;
      return collection;
    },
    collection: function(name) {
      return collections[name];
    },
    throwException: function(message) {
      throw ("Catwalk.js: " + message + ".");
    }
  }, {});
  $window.Catwalk = Catwalk;
})(window);

"use strict";
(function($Catwalk, $object) {
  "use strict";
  var CATWALK_PROPERTY = '__catwalkId';
  var CatwalkCollection = function CatwalkCollection() {
    var name = arguments[0] !== (void 0) ? arguments[0] : '';
    var blueprint = arguments[1] !== (void 0) ? arguments[1] : {};
    if (name === '') {
      this.throwException('You must specify a name for the collection');
    }
    this.id = 0;
    this.name = name;
    this.models = [];
    this.blueprint = $object.freeze(blueprint);
  };
  ($traceurRuntime.createClass)(CatwalkCollection, {
    getModels: $traceurRuntime.initGeneratorFunction(function $__4() {
      var $__2,
          $__3,
          model;
      return $traceurRuntime.createGeneratorInstance(function($ctx) {
        while (true)
          switch ($ctx.state) {
            case 0:
              $__2 = this.models[Symbol.iterator]();
              $ctx.state = 14;
              break;
            case 14:
              $ctx.state = (!($__3 = $__2.next()).done) ? 9 : -2;
              break;
            case 9:
              $ctx.pushTry(7, null);
              $ctx.state = 10;
              break;
            case 10:
              throw undefined;
              $ctx.state = 12;
              break;
            case 12:
              $ctx.popTry();
              $ctx.state = 14;
              break;
            case 7:
              $ctx.popTry();
              model = $ctx.storedException;
              $ctx.state = 5;
              break;
            case 5:
              model = $__3.value;
              $ctx.state = 6;
              break;
            case 6:
              $ctx.state = 2;
              return model;
            case 2:
              $ctx.maybeThrow();
              $ctx.state = 14;
              break;
            default:
              return $ctx.end();
          }
      }, $__4, this);
    }),
    createModel: function() {
      var properties = arguments[0] !== (void 0) ? arguments[0] : {};
      var model = this.cleanModel(properties);
      model[CATWALK_PROPERTY] = ++this.id;
      this.models.push($object.freeze(model));
      return model;
    },
    deleteModel: function(model) {
      this.spliceModel(model);
      return model;
    },
    spliceModel: function(model) {
      var index = this.models.indexOf(model);
      this.models.splice(index, 1);
    },
    cleanModel: function(properties) {
      var model = this.iterateProperties(properties);
      return this.iterateBlueprint(model);
    },
    updateModel: function(model, properties) {
      var updatedModel = {};
      $object.keys(model).forEach((function(property) {
        updatedModel[property] = model[property];
      }));
      $object.keys(properties).forEach((function(property) {
        updatedModel[property] = properties[property];
      }));
      updatedModel = this.cleanModel(updatedModel);
      updatedModel[CATWALK_PROPERTY] = model[CATWALK_PROPERTY];
      this.spliceModel(model);
      this.models.push($object.freeze(updatedModel));
      return updatedModel;
    },
    clearModels: function() {
      this.models.length = 0;
    },
    iterateBlueprint: function(model) {
      var $__0 = this;
      $object.keys(this.blueprint).forEach((function(property) {
        if (typeof model[property] === 'undefined') {
          try {
            throw undefined;
          } catch (propertyHandler) {
            {
              propertyHandler = $__0.blueprint[property];
              model[property] = propertyHandler();
            }
          }
        }
      }));
      return model;
    },
    iterateProperties: function(properties) {
      var $__0 = this;
      var model = {};
      $object.keys(properties).forEach((function(property) {
        var value = properties[property],
            propertyHandler = $__0.blueprint[property];
        if (typeof propertyHandler === 'undefined') {
          return;
        }
        if (typeof propertyHandler === 'function') {
          value = propertyHandler(value);
        }
        model[property] = value;
      }));
      return model;
    }
  }, {}, $Catwalk);
  $Catwalk.Collection = CatwalkCollection;
})(window.Catwalk, window.Object);

"use strict";
(function($window, $Catwalk) {
  "use strict";
  var CatwalkTypecast = function CatwalkTypecast() {};
  ($traceurRuntime.createClass)(CatwalkTypecast, {
    string: function() {
      return function typecastString() {
        var value = arguments[0] !== (void 0) ? arguments[0] : '';
        return $window.String(value);
      };
    },
    number: function() {
      return function typecastNumber() {
        var value = arguments[0] !== (void 0) ? arguments[0] : 0;
        return $window.parseInt(value);
      };
    },
    custom: function(typecastFn) {
      return typecastFn;
    }
  }, {});
  $Catwalk.Typecast = CatwalkTypecast;
})(window, window.Catwalk);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNhdHdhbGsuanMiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMSIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8yIiwiQ29sbGVjdGlvbi5qcyIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8zIiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzE1IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzE0IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzUiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMTMiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvNCIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8xMCIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci83IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzgiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvOSIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8xMSIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci82IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzEyIiwiVHlwZWNhc3QuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQSxBQUFDLFNBQVMsT0FBTTtBQUVaLGFBQVcsQ0FBQztBQU1aLEFBQUksSUFBQSxDQUFBLFdBQVUsRUFBSSxHQUFDLENBQUM7QUNSeEIsQUFBSSxJQUFBLFVEZUEsU0FBTSxRQUFNLENBTUcsQUFBQyxDQUFFO0FBQ1YsT0FBRyxTQUFTLEVBQUksSUFBSSxDQUFBLE9BQU0sUUFBUSxTQUFTLEFBQUMsRUFBQyxDQUFDO0VDdEJsQixBRHVCaEMsQ0N2QmdDO0FDQXhDLEVBQUMsZUFBYyxZQUFZLENBQUMs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QztJQUVoQjtPQXpMNEIsU0FBTyxDQ2RhO0FENE1wRCxTQUFPLFdBQVcsRUFBSSxrQkFBZ0IsQ0FBQztBQUUzQyxDQUFDLEFBQUMsQ0FBQyxNQUFLLFFBQVEsQ0FBRyxDQUFBLE1BQUssT0FBTyxDQUFDLENBQUM7QUFBQTtBYy9NakM7QUFBQSxBQUFDLFNBQVMsT0FBTSxDQUFHLENBQUEsUUFBTztBQUV0QixhQUFXLENBQUM7QWhCRmhCLEFBQUksSUFBQSxrQmdCU0EsU0FBTSxnQkFBYyxLaEJUZ0IsQWdCc0RwQyxDaEJ0RG9DO0FDQXhDLEVBQUMsZUFBYyxZQUFZLENBQUMsQUFBQztBZWVyQixTQUFLLENBQUwsVUFBTSxBQUFDO0FBT0gsV0FBTyxTQUFTLGVBQWEsQ0FBRSxBQUFTLENBQUc7VUFBWixNQUFJLDZDQUFJLEdBQUM7QUFDcEMsYUFBTyxDQUFBLE9BQU0sT0FBTyxBQUFDLENBQUMsS0FBSSxDQUFDLENBQUM7TUFDaEMsQ0FBQztJQUVMO0FBTUEsU0FBSyxDQUFMLFVBQU0sQUFBQztBQU9ILFdBQU8sU0FBUyxlQUFhLENBQUUsQUFBUSxDQUFHO1VBQVgsTUFBSSw2Q0FBSSxFQUFBO0FBQ25DLGFBQU8sQ0FBQSxPQUFNLFNBQVMsQUFBQyxDQUFDLEtBQUksQ0FBQyxDQUFDO01BQ2xDLENBQUM7SUFFTDtBQU9BLFNBQUssQ0FBTCxVQUFPLFVBQVMsQ0FBRztBQUNmLFdBQU8sV0FBUyxDQUFDO0lBQ3JCO0FBQUEsT2ZwRDZFO0FleURqRixTQUFPLFNBQVMsRUFBSSxnQkFBYyxDQUFDO0FBRXZDLENBQUMsQUFBQyxDQUFDLE1BQUssQ0FBRyxDQUFBLE1BQUssUUFBUSxDQUFDLENBQUM7QUFBQSIsImZpbGUiOiJjYXR3YWxrLmVzNS5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigkd2luZG93KSB7XG5cbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBjb2xsZWN0aW9uc1xuICAgICAqIEB0eXBlIHtBcnJheX1cbiAgICAgKi9cbiAgICB2YXIgY29sbGVjdGlvbnMgPSBbXTtcblxuICAgIC8qKlxuICAgICAqIEBjbGFzcyBDYXR3YWxrXG4gICAgICogQGF1dGhvciBBZGFtIFRpbWJlcmxha2VcbiAgICAgKiBAbGluayBodHRwczovL2dpdGh1Yi5jb20vV2lsZGhvbmV5L0NhdHdhbGsuanNcbiAgICAgKi9cbiAgICBjbGFzcyBDYXR3YWxrIHtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQGNvbnN0cnVjdG9yXG4gICAgICAgICAqIEByZXR1cm4ge0NhdHdhbGt9XG4gICAgICAgICAqL1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIHRoaXMudHlwZWNhc3QgPSBuZXcgJHdpbmRvdy5DYXR3YWxrLlR5cGVjYXN0KCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1ldGhvZCBjcmVhdGVDb2xsZWN0aW9uXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wZXJ0aWVzXG4gICAgICAgICAqIEByZXR1cm4ge0NhdHdhbGsuQ29sbGVjdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgIGNyZWF0ZUNvbGxlY3Rpb24obmFtZSwgcHJvcGVydGllcykge1xuXG4gICAgICAgICAgICB2YXIgY29sbGVjdGlvbiAgICA9IG5ldyAkd2luZG93LkNhdHdhbGsuQ29sbGVjdGlvbihuYW1lLCBwcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgIGNvbGxlY3Rpb25zW25hbWVdID0gY29sbGVjdGlvbjtcbiAgICAgICAgICAgIHJldHVybiBjb2xsZWN0aW9uO1xuXG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1ldGhvZCBjb2xsZWN0aW9uXG4gICAgICAgICAqIEBwYXJhbSBuYW1lIHtTdHJpbmd9XG4gICAgICAgICAqIEByZXR1cm4ge0NhdHdhbGsuQ29sbGVjdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgIGNvbGxlY3Rpb24obmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb25zW25hbWVdO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZXRob2QgdGhyb3dFeGNlcHRpb25cbiAgICAgICAgICogQHRocm93IEV4Y2VwdGlvblxuICAgICAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhyb3dFeGNlcHRpb24obWVzc2FnZSkge1xuICAgICAgICAgICAgdGhyb3cgYENhdHdhbGsuanM6ICR7bWVzc2FnZX0uYDtcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgLy8gRXhwb3NlIHRoZSBgQ2F0d2Fsa2AgY2xhc3MuXG4gICAgJHdpbmRvdy5DYXR3YWxrID0gQ2F0d2FsaztcblxufSkod2luZG93KTsiLCJ2YXIgJF9fcGxhY2Vob2xkZXJfXzAgPSAkX19wbGFjZWhvbGRlcl9fMSIsIigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKCRfX3BsYWNlaG9sZGVyX18wLCAkX19wbGFjZWhvbGRlcl9fMSwgJF9fcGxhY2Vob2xkZXJfXzIpIiwiKGZ1bmN0aW9uKCRDYXR3YWxrLCAkb2JqZWN0KSB7XG5cbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdGFudCBDQVRXQUxLX1BST1BFUlRZXG4gICAgICogQHR5cGUge1N0cmluZ31cbiAgICAgKi9cbiAgICBjb25zdCBDQVRXQUxLX1BST1BFUlRZID0gJ19fY2F0d2Fsa0lkJztcblxuICAgIC8qKlxuICAgICAqIEBjbGFzcyBDYXR3YWxrXG4gICAgICogQGF1dGhvciBBZGFtIFRpbWJlcmxha2VcbiAgICAgKiBAbGluayBodHRwczovL2dpdGh1Yi5jb20vV2lsZGhvbmV5L0NhdHdhbGsuanNcbiAgICAgKi9cbiAgICBjbGFzcyBDYXR3YWxrQ29sbGVjdGlvbiBleHRlbmRzICRDYXR3YWxrIHtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1ldGhvZCBjb25zdHJ1Y3RvclxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gYmx1ZXByaW50XG4gICAgICAgICAqIEByZXR1cm4ge0NhdHdhbGtDb2xsZWN0aW9ufVxuICAgICAgICAgKi9cbiAgICAgICAgY29uc3RydWN0b3IobmFtZSA9ICcnLCBibHVlcHJpbnQgPSB7fSkge1xuXG4gICAgICAgICAgICBpZiAobmFtZSA9PT0gJycpIHtcblxuICAgICAgICAgICAgICAgIC8vIE5vIGB1bmRlZmluZWRgIHZhbHVlcyBhbGxvd2VkIVxuICAgICAgICAgICAgICAgIHRoaXMudGhyb3dFeGNlcHRpb24oJ1lvdSBtdXN0IHNwZWNpZnkgYSBuYW1lIGZvciB0aGUgY29sbGVjdGlvbicpO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuaWQgICAgICAgICA9IDA7XG4gICAgICAgICAgICB0aGlzLm5hbWUgICAgICAgPSBuYW1lO1xuICAgICAgICAgICAgdGhpcy5tb2RlbHMgICAgID0gW107XG4gICAgICAgICAgICB0aGlzLmJsdWVwcmludCAgPSAkb2JqZWN0LmZyZWV6ZShibHVlcHJpbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZXRob2QgZ2V0TW9kZWxzXG4gICAgICAgICAqIEByZXR1cm4ge09iamVjdH1cbiAgICAgICAgICogQGdlbmVyYXRvclxuICAgICAgICAgKi9cbiAgICAgICAgKmdldE1vZGVscygpIHtcblxuICAgICAgICAgICAgZm9yIChsZXQgbW9kZWwgb2YgdGhpcy5tb2RlbHMpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCBtb2RlbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZXRob2QgY3JlYXRlTW9kZWxcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IFtwcm9wZXJ0aWVzPXt9XVxuICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICAgY3JlYXRlTW9kZWwocHJvcGVydGllcyA9IHt9KSB7XG5cbiAgICAgICAgICAgIGxldCBtb2RlbCA9IHRoaXMuY2xlYW5Nb2RlbChwcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgIG1vZGVsW0NBVFdBTEtfUFJPUEVSVFldID0gKyt0aGlzLmlkO1xuXG4gICAgICAgICAgICAvLyBNYWtlIHRoZSBtb2RlbCBpbW11dGFibGUsIGFuZCB0aGVuIGFkZCBpdCB0byB0aGUgYXJyYXkuXG4gICAgICAgICAgICB0aGlzLm1vZGVscy5wdXNoKCRvYmplY3QuZnJlZXplKG1vZGVsKSk7XG4gICAgICAgICAgICByZXR1cm4gbW9kZWw7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWV0aG9kIGRlbGV0ZU1vZGVsXG4gICAgICAgICAqIEBwYXJhbSBtb2RlbCB7T2JqZWN0fVxuICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICBkZWxldGVNb2RlbChtb2RlbCkge1xuICAgICAgICAgICAgdGhpcy5zcGxpY2VNb2RlbChtb2RlbCk7XG4gICAgICAgICAgICByZXR1cm4gbW9kZWw7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1ldGhvZCBzcGxpY2VNb2RlbFxuICAgICAgICAgKiBAcGFyYW0gbW9kZWwge09iamVjdH1cbiAgICAgICAgICovXG4gICAgICAgIHNwbGljZU1vZGVsKG1vZGVsKSB7XG4gICAgICAgICAgICBsZXQgaW5kZXggPSB0aGlzLm1vZGVscy5pbmRleE9mKG1vZGVsKTtcbiAgICAgICAgICAgIHRoaXMubW9kZWxzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1ldGhvZCBjbGVhbk1vZGVsXG4gICAgICAgICAqIEBwYXJhbSBwcm9wZXJ0aWVzIHtPYmplY3R9XG4gICAgICAgICAqIEByZXR1cm4ge09iamVjdH1cbiAgICAgICAgICovXG4gICAgICAgIGNsZWFuTW9kZWwocHJvcGVydGllcykge1xuICAgICAgICAgICAgbGV0IG1vZGVsID0gdGhpcy5pdGVyYXRlUHJvcGVydGllcyhwcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLml0ZXJhdGVCbHVlcHJpbnQobW9kZWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZXRob2QgdXBkYXRlTW9kZWxcbiAgICAgICAgICogQHBhcmFtIG1vZGVsIHtPYmplY3R9XG4gICAgICAgICAqIEBwYXJhbSBwcm9wZXJ0aWVzIHtPYmplY3R9XG4gICAgICAgICAqIEByZXR1cm4ge09iamVjdH1cbiAgICAgICAgICovXG4gICAgICAgIHVwZGF0ZU1vZGVsKG1vZGVsLCBwcm9wZXJ0aWVzKSB7XG5cbiAgICAgICAgICAgIGxldCB1cGRhdGVkTW9kZWwgPSB7fTtcblxuICAgICAgICAgICAgJG9iamVjdC5rZXlzKG1vZGVsKS5mb3JFYWNoKHByb3BlcnR5ID0+IHtcblxuICAgICAgICAgICAgICAgIC8vIENsb25lIHRoZSBjdXJyZW50IG1vZGVsIHNpbmNlIGl0IGlzIGZyb3plbi5cbiAgICAgICAgICAgICAgICB1cGRhdGVkTW9kZWxbcHJvcGVydHldID0gbW9kZWxbcHJvcGVydHldO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJG9iamVjdC5rZXlzKHByb3BlcnRpZXMpLmZvckVhY2gocHJvcGVydHkgPT4ge1xuXG4gICAgICAgICAgICAgICAgLy8gSXRlcmF0ZSBvdmVyIHRoZSBwcm9wZXJ0aWVzIHRvIGJlIHVwZGF0ZWQgZm9yIHRoZSBtb2RlbC5cbiAgICAgICAgICAgICAgICB1cGRhdGVkTW9kZWxbcHJvcGVydHldID0gcHJvcGVydGllc1twcm9wZXJ0eV07XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB1cGRhdGVkTW9kZWwgPSB0aGlzLmNsZWFuTW9kZWwodXBkYXRlZE1vZGVsKTtcbiAgICAgICAgICAgIHVwZGF0ZWRNb2RlbFtDQVRXQUxLX1BST1BFUlRZXSA9IG1vZGVsW0NBVFdBTEtfUFJPUEVSVFldO1xuXG4gICAgICAgICAgICB0aGlzLnNwbGljZU1vZGVsKG1vZGVsKTtcbiAgICAgICAgICAgIHRoaXMubW9kZWxzLnB1c2goJG9iamVjdC5mcmVlemUodXBkYXRlZE1vZGVsKSk7XG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlZE1vZGVsO1xuXG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1ldGhvZCBjbGVhck1vZGVsc1xuICAgICAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAgICAgKi9cbiAgICAgICAgY2xlYXJNb2RlbHMoKSB7XG4gICAgICAgICAgICB0aGlzLm1vZGVscy5sZW5ndGggPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlc3BvbnNpYmxlIGZvciBpdGVyYXRpbmcgb3ZlciB0aGUgYmx1ZXByaW50IHRvIGRldGVybWluZSBpZiBhbnkgcHJvcGVydGllcyBhcmUgbWlzc2luZ1xuICAgICAgICAgKiBmcm9tIHRoZSBjdXJyZW50IG1vZGVsLCB0aGF0IGhhdmUgYmVlbiBkZWZpbmVkIGluIHRoZSBibHVlcHJpbnQgYW5kIHRoZXJlZm9yZSBzaG91bGQgYmVcbiAgICAgICAgICogcHJlc2VudC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1ldGhvZCBpdGVyYXRlQmx1ZXByaW50XG4gICAgICAgICAqIEBwYXJhbSBtb2RlbCB7T2JqZWN0fVxuICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICBpdGVyYXRlQmx1ZXByaW50KG1vZGVsKSB7XG5cbiAgICAgICAgICAgICRvYmplY3Qua2V5cyh0aGlzLmJsdWVwcmludCkuZm9yRWFjaChwcm9wZXJ0eSA9PiB7XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG1vZGVsW3Byb3BlcnR5XSA9PT0gJ3VuZGVmaW5lZCcpIHtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgcHJvcGVydHlIYW5kbGVyID0gdGhpcy5ibHVlcHJpbnRbcHJvcGVydHldO1xuICAgICAgICAgICAgICAgICAgICBtb2RlbFtwcm9wZXJ0eV0gICAgID0gcHJvcGVydHlIYW5kbGVyKCk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gbW9kZWw7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXNwb25zaWJsZSBmb3IgaXRlcmF0aW5nIG92ZXIgdGhlIHBhc3NlZCBpbiBtb2RlbCBwcm9wZXJ0aWVzIHRvIGVuc3VyZSB0aGV5J3JlIGluIHRoZSBibHVlcHJpbnQsXG4gICAgICAgICAqIGFuZCB0eXBlY2FzdGluZyB0aGUgcHJvcGVydGllcyBiYXNlZCBvbiB0aGUgZGVmaW5lIGJsdWVwcmludCBmb3IgdGhlIGN1cnJlbnQgY29sbGVjdGlvbi5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1ldGhvZCBpdGVyYXRlUHJvcGVydGllc1xuICAgICAgICAgKiBAcGFyYW0gcHJvcGVydGllcyB7T2JqZWN0fVxuICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICBpdGVyYXRlUHJvcGVydGllcyhwcm9wZXJ0aWVzKSB7XG5cbiAgICAgICAgICAgIHZhciBtb2RlbCA9IHt9O1xuXG4gICAgICAgICAgICAkb2JqZWN0LmtleXMocHJvcGVydGllcykuZm9yRWFjaChwcm9wZXJ0eSA9PiB7XG5cbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgICAgICAgICAgID0gcHJvcGVydGllc1twcm9wZXJ0eV0sXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5SGFuZGxlciA9IHRoaXMuYmx1ZXByaW50W3Byb3BlcnR5XTtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcHJvcGVydHlIYW5kbGVyID09PSAndW5kZWZpbmVkJykge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFByb3BlcnR5IGRvZXNuJ3QgYmVsb25nIGluIHRoZSBtb2RlbCBiZWNhdXNlIGl0J3Mgbm90IGluIHRoZSBibHVlcHJpbnQuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcHJvcGVydHlIYW5kbGVyID09PSAnZnVuY3Rpb24nKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVHlwZWNhc3QgcHJvcGVydHkgdG8gdGhlIGRlZmluZWQgdHlwZS5cbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBwcm9wZXJ0eUhhbmRsZXIodmFsdWUpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbW9kZWxbcHJvcGVydHldID0gdmFsdWU7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gbW9kZWw7XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgLy8gRXhwb3NlIHRoZSBgQ2F0d2Fsay5Db2xsZWN0aW9uYCBwcm9wZXJ0eS5cbiAgICAkQ2F0d2Fsay5Db2xsZWN0aW9uID0gQ2F0d2Fsa0NvbGxlY3Rpb247XG5cbn0pKHdpbmRvdy5DYXR3YWxrLCB3aW5kb3cuT2JqZWN0KTsiLCIoJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKSgkX19wbGFjZWhvbGRlcl9fMCwgJF9fcGxhY2Vob2xkZXJfXzEsICRfX3BsYWNlaG9sZGVyX18yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzMpIiwiJHRyYWNldXJSdW50aW1lLmluaXRHZW5lcmF0b3JGdW5jdGlvbigkX19wbGFjZWhvbGRlcl9fMCkiLCJyZXR1cm4gJF9fcGxhY2Vob2xkZXJfXzAoXG4gICAgICAgICAgICAgICRfX3BsYWNlaG9sZGVyX18xLFxuICAgICAgICAgICAgICAkX19wbGFjZWhvbGRlcl9fMiwgdGhpcyk7IiwiJHRyYWNldXJSdW50aW1lLmNyZWF0ZUdlbmVyYXRvckluc3RhbmNlIiwiZnVuY3Rpb24oJGN0eCkge1xuICAgICAgd2hpbGUgKHRydWUpICRfX3BsYWNlaG9sZGVyX18wXG4gICAgfSIsIlxuICAgICAgICBmb3IgKHZhciAkX19wbGFjZWhvbGRlcl9fMCA9XG4gICAgICAgICAgICAgICAgICRfX3BsYWNlaG9sZGVyX18xW1N5bWJvbC5pdGVyYXRvcl0oKSxcbiAgICAgICAgICAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzI7XG4gICAgICAgICAgICAgISgkX19wbGFjZWhvbGRlcl9fMyA9ICRfX3BsYWNlaG9sZGVyX180Lm5leHQoKSkuZG9uZTsgKSB7XG4gICAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzU7XG4gICAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzY7XG4gICAgICAgIH0iLCIkY3R4LnN0YXRlID0gKCRfX3BsYWNlaG9sZGVyX18wKSA/ICRfX3BsYWNlaG9sZGVyX18xIDogJF9fcGxhY2Vob2xkZXJfXzI7XG4gICAgICAgIGJyZWFrIiwiJGN0eC5wdXNoVHJ5KFxuICAgICAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzAsXG4gICAgICAgICAgICAkX19wbGFjZWhvbGRlcl9fMSk7IiwiJGN0eC5wb3BUcnkoKTsiLCJcbiAgICAgICAgICAgICAgJGN0eC5wb3BUcnkoKTtcbiAgICAgICAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzAgPSAkY3R4LnN0b3JlZEV4Y2VwdGlvbjsiLCJyZXR1cm4gJF9fcGxhY2Vob2xkZXJfXzAiLCIkY3R4Lm1heWJlVGhyb3coKSIsInJldHVybiAkY3R4LmVuZCgpIiwiKGZ1bmN0aW9uKCR3aW5kb3csICRDYXR3YWxrKSB7XG5cbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIC8qKlxuICAgICAqIEBjbGFzcyBDYXR3YWxrXG4gICAgICogQGF1dGhvciBBZGFtIFRpbWJlcmxha2VcbiAgICAgKiBAbGluayBodHRwczovL2dpdGh1Yi5jb20vV2lsZGhvbmV5L0NhdHdhbGsuanNcbiAgICAgKi9cbiAgICBjbGFzcyBDYXR3YWxrVHlwZWNhc3Qge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWV0aG9kIHN0cmluZ1xuICAgICAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgIHN0cmluZygpIHtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAbWV0aG9kIHR5cGVjYXN0U3RyaW5nXG4gICAgICAgICAgICAgKiBAcGFyYW0gW3ZhbHVlPScnXSB7U3RyaW5nfEJvb2xlYW58TnVtYmVyfVxuICAgICAgICAgICAgICogQHJldHVybiB7U3RyaW5nfVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gdHlwZWNhc3RTdHJpbmcodmFsdWUgPSAnJykge1xuICAgICAgICAgICAgICAgIHJldHVybiAkd2luZG93LlN0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQG1ldGhvZCBudW1iZXJcbiAgICAgICAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAgICAgICAqL1xuICAgICAgICBudW1iZXIoKSB7XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQG1ldGhvZCB7QW5vbnltb3VzfVxuICAgICAgICAgICAgICogQHBhcmFtIFt2YWx1ZT0wXSB7U3RyaW5nfEJvb2xlYW58TnVtYmVyfVxuICAgICAgICAgICAgICogQHJldHVybiB7U3RyaW5nfVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gdHlwZWNhc3ROdW1iZXIodmFsdWUgPSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICR3aW5kb3cucGFyc2VJbnQodmFsdWUpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZXRob2QgY3VzdG9tXG4gICAgICAgICAqIEBwYXJhbSB0eXBlY2FzdEZuIHtGdW5jdGlvbn1cbiAgICAgICAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAgICAgICAqL1xuICAgICAgICBjdXN0b20odHlwZWNhc3RGbikge1xuICAgICAgICAgICAgcmV0dXJuIHR5cGVjYXN0Rm47XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIC8vIEV4cG9zZSB0aGUgYENhdHdhbGsuQ29sbGVjdGlvbmAgcHJvcGVydHkuXG4gICAgJENhdHdhbGsuVHlwZWNhc3QgPSBDYXR3YWxrVHlwZWNhc3Q7XG5cbn0pKHdpbmRvdywgd2luZG93LkNhdHdhbGspOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==